
# Try with a default Amazon instance--- NOT WORKING

# Get CUDA going
# From: http://www.startup.ml/blog/deep-learning-ec2
# launch an Amazon default GPU instance:
# OS: Amazon Linux AMI 2015.03 (HVM), SSD Volume Type - ami-e7527ed7 image
# instance: g2.2xlarge
# root volume: 32GB

# ssh in: ssh -i /Volumes/Planning/Accounts/jmamzkp1.pem.txt ec2-user@PUBLICIP
sudo yum -y  update -y
sudo reboot
# ssh in: ssh -i /Volumes/Planning/Accounts/jmamzkp1.pem.txt ec2-user@PUBLICIP
sudo yum -y  groupinstall -y "Development tools"
wget http://us.download.nvidia.com/XFree86/Linux-x86_64/352.21/NVIDIA-Linux-x86_64-352.21.run
wget http://developer.download.nvidia.com/compute/cuda/7_0/Prod/local_installers/cuda_7.0.28_linux.run
sudo /bin/bash ./NVIDIA-Linux-x86_64-352.21.run # say yes to all
sudo /bin/bash ./cuda_7.0.28_linux.run # "q" to end license, say yes to all
nvidia-smi -q | head # you should see GRID K520 in the output
sudo yum -y  install python-devel python-nose python-setuptools gcc gcc-gfortran gcc-c++ blas-devel lapack-devel atlas-devel


# All the apt-get stuff from the earlier apt-get verson of this
sudo yum -y  install protobuf protobuf-compiler python-pip git emacs


# From: http://rocknrollnerd.github.io/ml/2015/05/27/leopard-sofa.html
# http://nbviewer.ipython.org/github/BVLC/caffe/blob/master/examples/classification.ipynb
sudo pip install numpy
# From http://stackoverflow.com/questions/2213551/installing-scipy-with-pip
sudo pip install cython
sudo yum -y  install libpng-devel freetype-devel
sudo pip install matplotlib
sudo pip install scipy
# From https://github.com/BVLC/caffe/issues/50
sudo pip install scikit-image
sudo pip install "ipython[all]"

export PYTHONPATH=/home/ec2-user/caffe/python:$PYTHONPATH

# From https://groups.google.com/forum/#!topic/caffe-users/9Q10WkpCGxs
sudo pip install protobuf


# From: https://github.com/BVLC/caffe/issues/1988
export LD_LIBRARY_PATH=/home/ec2-user/caffe/.build_release/lib/:$LD_LIBRARY_PATH

sudo yum -y install protobuf-devel protobuf-lite
# repoquery --list boost
sudo yum -y install boost boost-devel
sudo yum -y install cmake
# yum provides \*hdf5\*
# python --version
sudo yum -y install python27-scipy

# From: https://github.com/BVLC/caffe
git clone https://github.com/BVLC/caffe.git

git clone https://github.com/JohnMount/CaffeECSExample.git


cd caffe
cp Makefile.config.example Makefile.config
make all
# and error out over gflags (and maybe hdf5) bullshit


